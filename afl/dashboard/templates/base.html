<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}AgentFlow Dashboard{% endblock %}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/styles/github.min.css">
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/highlight.min.js"></script>
</head>
<body>
    <nav class="container-fluid">
        <ul>
            <li><a href="/v2/workflows"><strong>AgentFlow</strong></a></li>
        </ul>
        <ul>
            <li><a href="/v2/workflows"{% if active_tab == 'workflows' %} class="nav-active"{% endif %}>Workflows</a></li>
            <li><a href="/v2/servers"{% if active_tab == 'servers' %} class="nav-active"{% endif %}>Servers</a></li>
            <li class="nav-dropdown-container">
                <a href="#" class="nav-dropdown-toggle">More</a>
                <ul class="nav-dropdown">
                    <li><a href="/v2/handlers"{% if active_tab == 'handlers' %} class="nav-active"{% endif %}>Handlers</a></li>
                    <li><a href="/events">Events</a></li>
                    <li><a href="/tasks">Tasks</a></li>
                    <li><a href="/locks">Locks</a></li>
                    <li><a href="/sources">Sources</a></li>
                    <li><a href="/flows">Flows</a></li>
                    <li><a href="/runners">Runners</a></li>
                    <li><a href="/namespaces">Namespaces</a></li>
                    <li><a href="/workflows/new">New Workflow</a></li>
                </ul>
            </li>
        </ul>
    </nav>

    {% block subnav %}{% endblock %}

    <main class="container">
        {% block content %}{% endblock %}
    </main>

    <footer class="container">
        <small>AgentFlow Dashboard</small>
    </footer>

    <script>hljs.highlightAll();</script>
    <script>
    // Convert UTC timestamps to the viewer's local timezone
    document.querySelectorAll("time[data-ts]").forEach(function(el) {
        var ms = parseInt(el.getAttribute("data-ts"), 10);
        if (isNaN(ms)) return;
        var d = new Date(ms);
        var pad = function(n) { return n < 10 ? "0" + n : n; };
        el.textContent = d.getFullYear() + "-" + pad(d.getMonth() + 1) + "-" +
            pad(d.getDate()) + " " + pad(d.getHours()) + ":" +
            pad(d.getMinutes()) + ":" + pad(d.getSeconds());
    });
    </script>
    {% block scripts %}{% endblock %}
</body>
</html>
