"""OSM region registry data for Geofabrik downloads.

Provides REGION_REGISTRY mapping namespace → { FacetName: geofabrik_path }
and a _make_handler() factory used by operations_handlers.py.

Note: The actual event facet for cache operations is osm.geo.Operations.Cache,
handled by operations_handlers.py. The individual region facets (e.g.,
osm.geo.cache.Africa.Malawi) are regular facets with andThen bodies that
expand inline — they never produce event tasks.
"""

from .downloader import download


def _make_handler(region_path: str):
    """Create a handler function that downloads and caches a region."""

    def handler(payload: dict) -> dict:
        step_log = payload.get("_step_log")
        cache = download(region_path)
        source = cache.get("source", "unknown")
        if step_log:
            step_log(f"Cache: {region_path} (source={source})")
        return {"cache": cache}

    return handler


# Namespace → { FacetName: geofabrik_path }
REGION_REGISTRY: dict[str, dict[str, str]] = {
    "osm.geo.cache.Africa": {
        "AllAfrica": "africa",
        "Africa": "africa",
        "Algeria": "africa/algeria",
        "Angola": "africa/angola",
        "Benin": "africa/benin",
        "Botswana": "africa/botswana",
        "BurkinaFaso": "africa/burkina-faso",
        "Burundi": "africa/burundi",
        "CapeVerde": "africa/cape-verde",
        "Cameroon": "africa/cameroon",
        "CentralAfricanRepublic": "africa/central-african-republic",
        "Chad": "africa/chad",
        "Comores": "africa/comores",
        "Congo_Brazzaville": "africa/congo-brazzaville",
        "Congo_Kinshasa": "africa/congo-democratic-republic",
        "Djibouti": "africa/djibouti",
        "Egypt": "africa/egypt",
        "EquatorialGuinea": "africa/equatorial-guinea",
        "Eritrea": "africa/eritrea",
        "Eswatini": "africa/eswatini",
        "Ethiopia": "africa/ethiopia",
        "Gabon": "africa/gabon",
        "Gambia": "africa/gambia",
        "Ghana": "africa/ghana",
        "Guinea": "africa/guinea",
        "GuineaBissau": "africa/guinea-bissau",
        "Kenya": "africa/kenya",
        "Lesotho": "africa/lesotho",
        "Liberia": "africa/liberia",
        "Libya": "africa/libya",
        "Madagascar": "africa/madagascar",
        "Malawi": "africa/malawi",
        "Mali": "africa/mali",
        "Mauritania": "africa/mauritania",
        "Mauritius": "africa/mauritius",
        "Morocco": "africa/morocco",
        "Mozambique": "africa/mozambique",
        "Namibia": "africa/namibia",
        "Niger": "africa/niger",
        "Nigeria": "africa/nigeria",
        "Rwanda": "africa/rwanda",
        "SaoTomeAndPrincipe": "africa/sao-tome-and-principe",
        "Senegal": "africa/senegal",
        "Seychelles": "africa/seychelles",
        "SierraLeone": "africa/sierra-leone",
        "Somalia": "africa/somalia",
        "SouthAfrica": "africa/south-africa",
        "SouthSudan": "africa/south-sudan",
        "Sudan": "africa/sudan",
        "Tanzania": "africa/tanzania",
        "Togo": "africa/togo",
        "Tunisia": "africa/tunisia",
        "Uganda": "africa/uganda",
        "Zambia": "africa/zambia",
        "Zimbabwe": "africa/zimbabwe",
    },
    "osm.geo.cache.Asia": {
        "AllAsia": "asia",
        "Asia": "asia",
        "Afghanistan": "asia/afghanistan",
        "Armenia": "asia/armenia",
        "Azerbaijan": "asia/azerbaijan",
        "Bangladesh": "asia/bangladesh",
        "Bhutan": "asia/bhutan",
        "Brunei": "asia/brunei",
        "Cambodia": "asia/cambodia",
        "China": "asia/china",
        "EastTimor": "asia/east-timor",
        "GCCStates": "asia/gcc-states",
        "India": "asia/india",
        "Indonesia": "asia/indonesia",
        "Iran": "asia/iran",
        "Iraq": "asia/iraq",
        "Japan": "asia/japan",
        "Jordan": "asia/jordan",
        "Kazakhstan": "asia/kazakhstan",
        "Kyrgyzstan": "asia/kyrgyzstan",
        "Laos": "asia/laos",
        "Lebanon": "asia/lebanon",
        "Malaysia": "asia/malaysia-singapore-brunei",
        "Maldives": "asia/maldives",
        "Mongolia": "asia/mongolia",
        "Myanmar": "asia/myanmar",
        "Nepal": "asia/nepal",
        "NorthKorea": "asia/north-korea",
        "Pakistan": "asia/pakistan",
        "IsraelAndPalestine": "asia/israel-and-palestine",
        "Philippines": "asia/philippines",
        "SaudiArabia": "asia/saudi-arabia",
        "Singapore": "asia/malaysia-singapore-brunei",
        "SouthKorea": "asia/south-korea",
        "SriLanka": "asia/sri-lanka",
        "Syria": "asia/syria",
        "Tajikistan": "asia/tajikistan",
        "Thailand": "asia/thailand",
        "Turkmenistan": "asia/turkmenistan",
        "UnitedArabEmirates": "asia/gcc-states",
        "Uzbekistan": "asia/uzbekistan",
        "Vietnam": "asia/vietnam",
        "Yemen": "asia/yemen",
    },
    "osm.geo.cache.Australia": {
        "AllAustralia": "australia-oceania",
        "Australia": "australia-oceania/australia",
        "AmericanOceania": "australia-oceania/american-oceania",
        "CookIslands": "australia-oceania/cook-islands",
        "Fiji": "australia-oceania/fiji",
        "Kiribati": "australia-oceania/kiribati",
        "IleDeClipperton": "australia-oceania/ile-de-clipperton",
        "MarshallIslands": "australia-oceania/marshall-islands",
        "Micronesia": "australia-oceania/micronesia",
        "Nauru": "australia-oceania/nauru",
        "NewCaledonia": "australia-oceania/new-caledonia",
        "NewZealand": "australia-oceania/new-zealand",
        "Palau": "australia-oceania/palau",
        "PapuaNewGuinea": "australia-oceania/papua-new-guinea",
        "Samoa": "australia-oceania/samoa",
        "SolomonIslands": "australia-oceania/solomon-islands",
        "Tokelau": "australia-oceania/tokelau",
        "Tonga": "australia-oceania/tonga",
        "Tuvalu": "australia-oceania/tuvalu",
        "Vanuatu": "australia-oceania/vanuatu",
        "WallisAndFutuna": "australia-oceania/wallis-et-futuna",
    },
    "osm.geo.cache.Europe": {
        "AllEurope": "europe",
        "Europe": "europe",
        "Albania": "europe/albania",
        "Andorra": "europe/andorra",
        "Austria": "europe/austria",
        "Belarus": "europe/belarus",
        "Belgium": "europe/belgium",
        "BosniaAndHerzegovina": "europe/bosnia-herzegovina",
        "Bulgaria": "europe/bulgaria",
        "Croatia": "europe/croatia",
        "Cyprus": "europe/cyprus",
        "CzechRepublic": "europe/czech-republic",
        "Denmark": "europe/denmark",
        "Estonia": "europe/estonia",
        "Finland": "europe/finland",
        "France": "europe/france",
        "Germany": "europe/germany",
        "Greece": "europe/greece",
        "GeorgiaEU": "europe/georgia",
        "Hungary": "europe/hungary",
        "Iceland": "europe/iceland",
        "Ireland": "europe/ireland-and-northern-ireland",
        "Italy": "europe/italy",
        "Kosovo": "europe/kosovo",
        "Latvia": "europe/latvia",
        "Liechtenstein": "europe/liechtenstein",
        "Lithuania": "europe/lithuania",
        "Luxembourg": "europe/luxembourg",
        "Macedonia": "europe/macedonia",
        "Malta": "europe/malta",
        "Moldova": "europe/moldova",
        "Monaco": "europe/monaco",
        "Montenegro": "europe/montenegro",
        "Netherlands": "europe/netherlands",
        "Norway": "europe/norway",
        "Poland": "europe/poland",
        "Portugal": "europe/portugal",
        "Romania": "europe/romania",
        "Russia": "europe/russia",
        "Serbia": "europe/serbia",
        "Slovakia": "europe/slovakia",
        "Slovenia": "europe/slovenia",
        "Spain": "europe/spain",
        "Sweden": "europe/sweden",
        "Switzerland": "europe/switzerland",
        "Turkey": "europe/turkey",
        "Ukraine": "europe/ukraine",
        "UnitedKingdom": "europe/great-britain",
    },
    "osm.geo.cache.NorthAmerica": {
        "AllNorthAmerica": "north-america",
        "NorthAmerica": "north-america",
        "Canada": "north-america/canada",
        "Mexico": "north-america/mexico",
        "UnitedStates": "north-america/us",
        "Greenland": "north-america/greenland",
    },
    "osm.geo.cache.Canada": {
        "AllCanada": "north-america/canada",
        "Canada": "north-america/canada",
        "Alberta": "north-america/canada/alberta",
        "BritishColumbia": "north-america/canada/british-columbia",
        "Manitoba": "north-america/canada/manitoba",
        "NewBrunswick": "north-america/canada/new-brunswick",
        "NewfoundlandAndLabrador": "north-america/canada/newfoundland-and-labrador",
        "NovaScotia": "north-america/canada/nova-scotia",
        "Ontario": "north-america/canada/ontario",
        "PrinceEdwardIsland": "north-america/canada/prince-edward-island",
        "Quebec": "north-america/canada/quebec",
        "Saskatchewan": "north-america/canada/saskatchewan",
        "Yukon": "north-america/canada/yukon",
    },
    "osm.geo.cache.CentralAmerica": {
        "AllCentralAmerica": "central-america",
        "CentralAmerica": "central-america",
        "Bahamas": "central-america/bahamas",
        "Belize": "central-america/belize",
        "CostaRica": "central-america/costa-rica",
        "Cuba": "central-america/cuba",
        "ElSalvador": "central-america/el-salvador",
        "DominicanRepublic": "central-america/dominican-republic",
        "Guatemala": "central-america/guatemala",
        "Haiti": "central-america/haiti",
        "Honduras": "central-america/honduras",
        "Jamaica": "central-america/jamaica",
        "Nicaragua": "central-america/nicaragua",
        "Panama": "central-america/panama",
    },
    "osm.geo.cache.SouthAmerica": {
        "AllSouthAmerica": "south-america",
        "SouthAmerica": "south-america",
        "Argentina": "south-america/argentina",
        "Bolivia": "south-america/bolivia",
        "Brazil": "south-america/brazil",
        "Chile": "south-america/chile",
        "Colombia": "south-america/colombia",
        "Ecuador": "south-america/ecuador",
        "Guyana": "south-america/guyana",
        "Paraguay": "south-america/paraguay",
        "Peru": "south-america/peru",
        "Suriname": "south-america/suriname",
        "Uruguay": "south-america/uruguay",
        "Venezuela": "south-america/venezuela",
    },
    "osm.geo.cache.UnitedStates": {
        "AllUnitedStates": "north-america/us",
        "UnitedStates": "north-america/us",
        "Alabama": "north-america/us/alabama",
        "Alaska": "north-america/us/alaska",
        "Arizona": "north-america/us/arizona",
        "Arkansas": "north-america/us/arkansas",
        "California": "north-america/us/california",
        "Colorado": "north-america/us/colorado",
        "Connecticut": "north-america/us/connecticut",
        "Delaware": "north-america/us/delaware",
        "DistrictOfColumbia": "north-america/us/district-of-columbia",
        "Florida": "north-america/us/florida",
        "GeorgiaUS": "north-america/us/georgia",
        "Hawaii": "north-america/us/hawaii",
        "Idaho": "north-america/us/idaho",
        "Illinois": "north-america/us/illinois",
        "Indiana": "north-america/us/indiana",
        "Iowa": "north-america/us/iowa",
        "Kansas": "north-america/us/kansas",
        "Kentucky": "north-america/us/kentucky",
        "Louisiana": "north-america/us/louisiana",
        "Maine": "north-america/us/maine",
        "Maryland": "north-america/us/maryland",
        "Massachusetts": "north-america/us/massachusetts",
        "Michigan": "north-america/us/michigan",
        "Minnesota": "north-america/us/minnesota",
        "Mississippi": "north-america/us/mississippi",
        "Missouri": "north-america/us/missouri",
        "Montana": "north-america/us/montana",
        "Nebraska": "north-america/us/nebraska",
        "Nevada": "north-america/us/nevada",
        "NewHampshire": "north-america/us/new-hampshire",
        "NewJersey": "north-america/us/new-jersey",
        "NewMexico": "north-america/us/new-mexico",
        "NewYork": "north-america/us/new-york",
        "NorthCarolina": "north-america/us/north-carolina",
        "NorthDakota": "north-america/us/north-dakota",
        "Ohio": "north-america/us/ohio",
        "Oklahoma": "north-america/us/oklahoma",
        "Oregon": "north-america/us/oregon",
        "Pennsylvania": "north-america/us/pennsylvania",
        "RhodeIsland": "north-america/us/rhode-island",
        "SouthCarolina": "north-america/us/south-carolina",
        "SouthDakota": "north-america/us/south-dakota",
        "Tennessee": "north-america/us/tennessee",
        "Texas": "north-america/us/texas",
        "Utah": "north-america/us/utah",
        "Vermont": "north-america/us/vermont",
        "Virginia": "north-america/us/virginia",
        "Washington": "north-america/us/washington",
        "WestVirginia": "north-america/us/west-virginia",
        "Wisconsin": "north-america/us/wisconsin",
        "Wyoming": "north-america/us/wyoming",
    },
    "osm.geo.cache.Antarctica": {
        "AllAntarctica": "antarctica",
        "Antarctica": "antarctica",
    },
    "osm.geo.cache.Continents": {
        "AllContinents": "planet",
        "Planet": "planet",
        "Africa": "africa",
        "Antarctica": "antarctica",
        "Asia": "asia",
        "Australia": "australia-oceania",
        "CentralAmerica": "central-america",
        "Europe": "europe",
        "SouthAmerica": "south-america",
        "NorthAmerica": "north-america",
        "Russia": "russia",
    },
}
