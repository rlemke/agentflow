// OSM region resolution â€” resolve human-friendly names to Geofabrik downloads
//
// Translates names like "Colorado", "UK", "the Alps" into OSMCache structures
// suitable for downstream workflows (route extraction, elevation, mapping).
//
// Prerequisites: Compile with osmtypes.afl

namespace osm.geo.Region {
    use osm.types

    schema RegionResolution {
        query: String,
        matched_name: String,
        region_namespace: String,
        continent: String,
        geofabrik_path: String,
        is_ambiguous: Boolean,
        disambiguation: String
    }

    schema MultiRegionResolution {
        query: String,
        match_count: Long,
        is_geographic_feature: Boolean,
        regions: Json
    }

    schema RegionListResult {
        region_count: Long,
        regions: Json,
        feature_count: Long,
        geographic_features: Json
    }

    // Resolve a single region name to an OSMCache download
    // Returns the best match; use prefer_continent to disambiguate (e.g. "NorthAmerica" for Georgia the state)
    event facet ResolveRegion(name: String,
        prefer_continent: String = "") => (cache: OSMCache, resolution: RegionResolution)

    // Resolve a region name that may match multiple regions (e.g. "Alps", "Scandinavia")
    // Returns all matching caches for geographic features
    event facet ResolveRegions(name: String,
        prefer_continent: String = "") => (caches: Json, resolution: MultiRegionResolution)

    // List all available regions and geographic features
    event facet ListRegions(continent: String = "") => (result: RegionListResult)
}
